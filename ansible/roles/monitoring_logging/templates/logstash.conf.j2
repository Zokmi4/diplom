input {
    file {
      path => "/var/log/nginx/access.log"
      start_position => "beginning"
      sincedb_path => "/dev/null"
      tags => [ "nginx_access" ]
    }
    file {
      path => "/var/log/nginx/error.log"
      start_position => "beginning"
      sincedb_path => "/dev/null"
      tags => [ "nginx_error" ]
    }
    file {
      path => "/var/log/apache2/access.log"
      start_position => "beginning"
      sincedb_path => "/dev/null"
      tags => [ "apache_access" ]
    }
    file {
      path => "/var/log/apache2/error.log"
      start_position => "beginning"
      sincedb_path => "/dev/null"
      tags => [ "apache_error" ]
    }
  }
  
  filter {
    if "nginx_access" in [tags] {
      grok {
        match => { "message" => "%{COMBINEDAPACHELOG}" }
      }
    }
    if "apache_access" in [tags] {
      grok {
        match => { "message" => "%{COMBINEDAPACHELOG}" }
      }
    }
  }
  
  output {
    elasticsearch {
      hosts => ["localhost:9200"]
      index => "weblogs-%{+YYYY.MM.dd}"
    }
    stdout { codec => rubydebug }
  }
  